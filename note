#!/bin/bash

create_note () {
    if [ ! -f $note_path ]; then
        mkdir -p ~/notes/$year/$month/
        touch $note_path
        printf "$day-$month-$year\n---\n\n" > $note_path
        printf "Created new note: $note_path\n"
    else
        printf "Note \"$note_path\" already exists.\n"
    fi
}

print_info () {
    printf "Note preview:\n--------------------\n\n"
    head -n 8 $note_path
    printf "\n--------------------\n"
    printf "Note Stats:"
    stat -x $note_path
}

year=`date +'%Y'`
month=`date +'%m'`
day=`date +'%d'`
note_path=~/notes/$year/$month/$day.md

while [[ $# -gt 0 ]]
do
key="$1"

case $key in
    -e|--edit)
    printf "TODO: -e\n"
    shift
    shift
    exit 0
    ;;
    -p|--print)
    cat $note_path
    shift
    exit 0
    ;;
    -c|--create)
    create_note
    shift
    exit 0
    ;;
    -i|--info)
    print_info
    shift
    exit 0
    ;;
    -h|--help)
    printf "note - Note Keeper 0.1 (01 Aug 2018)

Usage: note [arguments]

Arguments:
    -h | --help                         Display usage guide.
    -e | --edit <DATE: year-month-day>  Open a specific note for editing.
    -p | --print                        Print the contents of a note.
    -c | --create                       Create a note but don't open it for editing.
    -i | --info                         Print information about a note.\n"
    exit 0
    ;;
    '')
    exit 1
    ;;
    *)
    printf "Unknown Argument \"$1\"\n"
    printf "Try \"note --help\" to see usage information.\n"
    exit 0
    ;;
esac
done

create_note

vim "+normal G$" +startinsert $note_path
